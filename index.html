<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Bluff Den - The Game</title>
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/script.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&family=Cherry+Swash:wght@400;700&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
</head>

<body>
    <div id="app-container">
        <header>
            <img src="assets/bunnyheader.png" alt="Rabbit" class="header-image left">
            <div class="header-content">
                <h1>Bluff Den</h1>
                <p>In the den, only the clever survive.</p>
            </div>
            <img src="assets/foxheader.png" alt="Fox" class="header-image right">
        </header>
        <main>
            <!-- SETUP SCREEN -->
            <div id="setup-screen" class="screen active">
                <div class="card">
                    <h2 style="text-align: center; margin-bottom: var(--spacing-2xl); color: var(--primary-color); font-size: 28px; padding-bottom: var(--spacing-sm); border-bottom: 2px solid var(--border-light);">Game Setup</h2>
                    <div class="player-count-container">
                        <label class="player-count-label" for="player-count">Number of players:</label>
                        
                        <div class="player-counter">
                            <button id="decrease-players" class="counter-btn" aria-label="Decrease players">‚àí</button>
                            <div class="counter-display" id="player-count-display">4</div>
                            <button id="increase-players" class="counter-btn" aria-label="Increase players">+</button>
                        </div>
                        
                        <input type="hidden" id="player-count" value="4">
                        <div class="counter-note">4-10 players</div>
                    </div>
                    
                    <div id="player-inputs"></div>
                </div>
                
                <button id="start-game-btn" class="btn">Start Game</button>
                
                <div id="rules-container">
                    <details>
                        <summary>Game Rules</summary>
                        <div id="rules-content">
                          <section id="game-overview">
                            <h2>1. Game Overview</h2>
                            <p>
                              In <strong>Bluff Den</strong>, each round splits players into:
                              <ul>
                                <li><strong>Foxes</strong> (all but one) who see the secret word</li>
                                <li><strong>Rabbit</strong> (one) who does not</li>
                              </ul>
                              First to 25 ü•ï carrots wins.
                            </p>
                            <ul>
                              <li><strong>Players:</strong> 4+</li>
                              <li><strong>Starting Carrots:</strong> 10 per player</li>
                              <li><strong>Bet Range:</strong> 1‚Äì3 ü•ï</li>
                            </ul>
                          </section>

                          <section id="round-flow">
                            <h2>2. Round Flow</h2>
                            <ol>
                              <li>
                                <strong>Word Grid Reveal (Pass the Phone):</strong>
                                Foxes see the secret word on the 3√ó6 grid; Rabbit sees only the blank grid.
                              </li>
                              <li>
                                <strong>Clue Round 1:</strong>
                                Each player shares a one-word (or short phrase) clue aloud.
                              </li>
                              <li>
                                <strong>The Wager:</strong>
                                Players secretly bet carrots. Foxes bet on catching the Rabbit; Rabbit bets on guessing the word.
                              </li>
                              <li>
                                <strong>Clue Round 2:</strong>
                                Each player gives a more specific second clue.
                              </li>
                              <li>
                                <strong>Reveal & Guess:</strong>
                                Everyone votes on who the Rabbit is. Then the Rabbit makes a secret guess from the grid.
                              </li>
                            </ol>
                          </section>

                          <section id="scoring">
                            <h2>3. Scoring & Payouts</h2>
                            <p>
                              Payouts depend on two outcomes:
                              <ul>
                                <li><strong>Catch Success:</strong> Did Foxes catch the Rabbit?</li>
                                <li><strong>Guess Success:</strong> Did the Rabbit guess correctly?</li>
                              </ul>
                              A <strong>2√ó Sabotage Bonus</strong> applies when one team succeeds and the other fails.
                            </p>
                            <ul>
                              <li>
                                <strong>1. Fox Decisive Victory</strong>
                                <br>Catch = ‚úîÔ∏è, Guess = ‚ùå  
                                Foxes win double their bets; Rabbit loses their bet.
                              </li>
                              <li>
                                <strong>2. Rabbit Masterful Escape</strong>
                                <br>Catch = ‚ùå, Guess = ‚úîÔ∏è  
                                Rabbit wins triple their bet; Foxes lose theirs.
                              </li>
                              <li>
                                <strong>3. Contested Outcome</strong>
                                <br>Catch = ‚úîÔ∏è, Guess = ‚úîÔ∏è  
                                No one wins‚Äîeveryone gets their bets back.
                              </li>
                              <li>
                                <strong>4. Total Failure</strong>
                                <br>Catch = ‚ùå, Guess = ‚ùå  
                                All bets are lost and removed from play.
                              </li>
                            </ul>
                          </section>

                          <section id="endgame">
                            <h2>4. End of Game</h2>
                            <p>
                              The game ends when any of these occur:
                              <ul>
                                <li>A player reaches 25 ü•ï carrots</li>
                                <li>A player's score drops to 0</li>
                                <li>10 rounds have been completed</li>
                              </ul>
                              Highest-scoring player wins.
                            </p>
                          </section>
                        </div>
                    </details>
                </div>
            </div>

            <!-- GAME SCREEN (Container for all active game phases) -->
            <div id="game-screen" class="screen">
                <div id="game-info-bar">
                    <span id="round-counter">Round 1 / 10</span>
                    <ul id="player-scores"></ul>
                </div>

                <div id="game-phase-container">
                    <!-- Pass Device Screen -->
                    <div id="pass-device-screen" class="screen">
                        <div class="card">
                            <h2 id="pass-to-player-name"></h2>
                            <p>Hand the device to the player above.</p>
                            <button id="show-role-btn" class="btn">Ready! Show My Role</button>
                        </div>
                    </div>
                    <!-- Role Reveal Screen -->
                    <div id="reveal-screen" class="screen">
                         <div class="card">
                            <h2 id="reveal-role-title"></h2>
                            <p id="reveal-instruction"></p>
                            <div id="reveal-word-grid" class="word-grid"></div>
                            <button id="role-revealed-btn" class="btn">I've Got It!</button>
                        </div>
                    </div>
                    <!-- Main Phase Screen (Clues, Wager, Verdict) -->
                    <div id="main-phase-screen" class="screen">
                        <div class="card">
                            <h2 id="phase-title"></h2>
                            <p id="phase-instruction"></p>
                            <div id="timer-container">
                                <div id="timer-display">0:20</div>
                                <div id="timer-label">Time Remaining</div>
                            </div>
                            <div id="action-input-area"></div>
                            <button id="submit-action-btn" class="btn">Submit</button>
                        </div>
                        <div id="main-word-grid-container">
                            <h3>Word Grid</h3>
                            <div id="main-word-grid" class="word-grid"></div>
                        </div>
                    </div>
                     <!-- Buffer Screen -->
                    <div id="buffer-screen" class="screen">
                        <div class="card buffer-screen">
                            <h2>üîÑ Pass to ${nextPlayer.name}</h2>
                            <p>Please hand the device to ${nextPlayer.name} and ensure the previous player looks away.</p>
                            <button id="continue-buffer-btn" class="btn">Ready - Continue</button>
                        </div>
                    </div>
                    <!-- Vote Results Screen -->
                    <div id="vote-results-screen" class="screen">
                        <div class="card">
                            <h2>üìä Voting Results</h2>
                            <div id="vote-results-content">
                                <!-- Content generated by JS -->
                            </div>
                            <button id="continue-after-votes-btn" class="btn">Reveal the Rabbit!</button>
                        </div>
                    </div>
                    <!-- Weasel Reveal Screen -->
                    <div id="weasel-reveal-screen" class="screen">
                        <div class="card">
                            <h2>üé≠ The Moment of Truth</h2>
                            <div id="weasel-reveal-content">
                                <!-- Content generated by JS -->
                            </div>
                            <button id="continue-to-guess-btn" class="btn">Continue to Rabbit's Guess</button>
                        </div>
                    </div>
                    <!-- Weasel Guess Screen -->
                    <div id="weasel-guess-screen" class="screen">
                        <div class="card">
                            <h2 id="weasel-guess-title">üê∞ Rabbit's Final Guess</h2>
                            <p id="weasel-guess-instruction">The Rabbit must now guess the secret word from the grid below. Everyone can watch!</p>
                            <div id="weasel-guess-grid" class="word-grid"></div>
                            <button id="submit-weasel-guess-btn" class="btn" style="display: none;">Submit Guess</button>
                        </div>
                    </div>
                    
                    <!-- Scoring Screen -->
                    <div id="scoring-screen" class="screen">
                        <div id="scoring-summary" class="card">
                            <!-- Content generated by JS -->
                        </div>
                        <button id="next-round-btn" class="btn">Next Round</button>
                    </div>
                    <!-- Game Over Screen -->
                    <div id="game-over-screen" class="screen">
                        <div class="card">
                            <h2 id="game-over-title">Game Over!</h2>
                            <p id="winner-announcement"></p>
                            <button id="play-again-btn" class="btn">Play Again</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>
</html>